import{r as p,R as z}from"./index-580b8df0.js";import{s as ce,l as L,o as g,j as ae,L as N,u as _,p as te,c as ve,d as W,P as xe,D as B,y as U,C as ge,m as ue}from"./open-closed-6ab898d8.js";import{L as Re,c as Oe,p as Ce,I as H,o as T,r as Ie,A as Se}from"./keyboard-46ff6cb9.js";import{s as he}from"./use-resolve-button-type-6b4df908.js";import{F as Pe,u as Te,a as S,x as ye}from"./use-tracked-pointer-511c0c47.js";import{m as se,n as De}from"./platform-ae94fb3f.js";function ne(e,n){let[r,o]=p.useState(e),a=ce(e);return L(()=>o(a.current),[a,o,...n]),r}function de(e={},n=null,r=[]){for(let[o,a]of Object.entries(e))be(r,pe(n,o),a);return r}function pe(e,n){return e?e+"["+n+"]":n}function be(e,n,r){if(Array.isArray(r))for(let[o,a]of r.entries())be(e,pe(n,o.toString()),a);else r instanceof Date?e.push([n,r.toISOString()]):typeof r=="boolean"?e.push([n,r?"1":"0"]):typeof r=="string"?e.push([n,r]):typeof r=="number"?e.push([n,`${r}`]):r==null?e.push([n,""]):de(r,n,e)}function Ee(e,n,r){let[o,a]=p.useState(r),l=e!==void 0,i=p.useRef(l),v=p.useRef(!1),m=p.useRef(!1);return l&&!i.current&&!v.current?(v.current=!0,i.current=l,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!l&&i.current&&!m.current&&(m.current=!0,i.current=l,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[l?e:o,g(s=>(l||a(s),n==null?void 0:n(s)))]}var Le=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Le||{}),Me=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(Me||{}),Fe=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Fe||{}),we=(e=>(e[e.OpenCombobox=0]="OpenCombobox",e[e.CloseCombobox=1]="CloseCombobox",e[e.GoToOption=2]="GoToOption",e[e.RegisterOption=3]="RegisterOption",e[e.UnregisterOption=4]="UnregisterOption",e[e.RegisterLabel=5]="RegisterLabel",e))(we||{});function oe(e,n=r=>r){let r=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,o=Se(n(e.options.slice()),l=>l.dataRef.current.domRef.current),a=r?o.indexOf(r):null;return a===-1&&(a=null),{options:o,activeOptionIndex:a}}let Ae={[1](e){var n;return(n=e.dataRef.current)!=null&&n.disabled||e.comboboxState===1?e:{...e,activeOptionIndex:null,comboboxState:1}},[0](e){var n;if((n=e.dataRef.current)!=null&&n.disabled||e.comboboxState===0)return e;let r=e.activeOptionIndex;if(e.dataRef.current){let{isSelected:o}=e.dataRef.current,a=e.options.findIndex(l=>o(l.dataRef.current.value));a!==-1&&(r=a)}return{...e,comboboxState:0,activeOptionIndex:r}},[2](e,n){var r,o,a,l;if((r=e.dataRef.current)!=null&&r.disabled||(o=e.dataRef.current)!=null&&o.optionsRef.current&&!((a=e.dataRef.current)!=null&&a.optionsPropsRef.current.static)&&e.comboboxState===1)return e;let i=oe(e);if(i.activeOptionIndex===null){let m=i.options.findIndex(s=>!s.dataRef.current.disabled);m!==-1&&(i.activeOptionIndex=m)}let v=ye(n,{resolveItems:()=>i.options,resolveActiveIndex:()=>i.activeOptionIndex,resolveId:m=>m.id,resolveDisabled:m=>m.dataRef.current.disabled});return{...e,...i,activeOptionIndex:v,activationTrigger:(l=n.trigger)!=null?l:1}},[3]:(e,n)=>{var r,o;let a={id:n.id,dataRef:n.dataRef},l=oe(e,v=>[...v,a]);e.activeOptionIndex===null&&(r=e.dataRef.current)!=null&&r.isSelected(n.dataRef.current.value)&&(l.activeOptionIndex=l.options.indexOf(a));let i={...e,...l,activationTrigger:1};return(o=e.dataRef.current)!=null&&o.__demoMode&&e.dataRef.current.value===void 0&&(i.activeOptionIndex=0),i},[4]:(e,n)=>{let r=oe(e,o=>{let a=o.findIndex(l=>l.id===n.id);return a!==-1&&o.splice(a,1),o});return{...e,...r,activationTrigger:1}},[5]:(e,n)=>({...e,labelId:n.id})},re=p.createContext(null);re.displayName="ComboboxActionsContext";function K(e){let n=p.useContext(re);if(n===null){let r=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,K),r}return n}let ie=p.createContext(null);ie.displayName="ComboboxDataContext";function V(e){let n=p.useContext(ie);if(n===null){let r=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,V),r}return n}function $e(e,n){return _(n.type,Ae,e,n)}let ke=p.Fragment;function _e(e,n){let{value:r,defaultValue:o,onChange:a,name:l,by:i=(b,x)=>b===x,disabled:v=!1,__demoMode:m=!1,nullable:s=!1,multiple:O=!1,...P}=e,[t=O?[]:void 0,u]=Ee(r,a,o),[I,c]=p.useReducer($e,{dataRef:p.createRef(),comboboxState:m?0:1,options:[],activeOptionIndex:null,activationTrigger:1,labelId:null}),R=p.useRef(!1),A=p.useRef({static:!1,hold:!1}),M=p.useRef(null),j=p.useRef(null),F=p.useRef(null),$=p.useRef(null),E=g(typeof i=="string"?(b,x)=>{let h=i;return(b==null?void 0:b[h])===(x==null?void 0:x[h])}:i),k=p.useCallback(b=>_(f.mode,{[1]:()=>t.some(x=>E(x,b)),[0]:()=>E(t,b)}),[t]),f=p.useMemo(()=>({...I,optionsPropsRef:A,labelRef:M,inputRef:j,buttonRef:F,optionsRef:$,value:t,defaultValue:o,disabled:v,mode:O?1:0,get activeOptionIndex(){if(R.current&&I.activeOptionIndex===null&&I.options.length>0){let b=I.options.findIndex(x=>!x.dataRef.current.disabled);if(b!==-1)return b}return I.activeOptionIndex},compare:E,isSelected:k,nullable:s,__demoMode:m}),[t,o,v,O,s,m,I]),C=p.useRef(f.activeOptionIndex!==null?f.options[f.activeOptionIndex]:null);p.useEffect(()=>{let b=f.activeOptionIndex!==null?f.options[f.activeOptionIndex]:null;C.current!==b&&(C.current=b)}),L(()=>{I.dataRef.current=f},[f]),Re([f.buttonRef,f.inputRef,f.optionsRef],()=>ee.closeCombobox(),f.comboboxState===0);let D=p.useMemo(()=>({open:f.comboboxState===0,disabled:v,activeIndex:f.activeOptionIndex,activeOption:f.activeOptionIndex===null?null:f.options[f.activeOptionIndex].dataRef.current.value,value:t}),[f,v,t]),d=g(b=>{let x=f.options.find(h=>h.id===b);x&&G(x.dataRef.current.value)}),w=g(()=>{if(f.activeOptionIndex!==null){let{dataRef:b,id:x}=f.options[f.activeOptionIndex];G(b.current.value),ee.goToOption(S.Specific,x)}}),y=g(()=>{c({type:0}),R.current=!0}),q=g(()=>{c({type:1}),R.current=!1}),J=g((b,x,h)=>(R.current=!1,b===S.Specific?c({type:2,focus:S.Specific,id:x,trigger:h}):c({type:2,focus:b,trigger:h}))),Q=g((b,x)=>(c({type:3,id:b,dataRef:x}),()=>{var h;((h=C.current)==null?void 0:h.id)===b&&(R.current=!0),c({type:4,id:b})})),X=g(b=>(c({type:5,id:b}),()=>c({type:5,id:null}))),G=g(b=>_(f.mode,{[0](){return u==null?void 0:u(b)},[1](){let x=f.value.slice(),h=x.findIndex(Z=>E(Z,b));return h===-1?x.push(b):x.splice(h,1),u==null?void 0:u(x)}})),ee=p.useMemo(()=>({onChange:G,registerOption:Q,registerLabel:X,goToOption:J,closeCombobox:q,openCombobox:y,selectActiveOption:w,selectOption:d}),[]),fe=n===null?{}:{ref:n},Y=p.useRef(null),me=te();return p.useEffect(()=>{Y.current&&o!==void 0&&me.addEventListener(Y.current,"reset",()=>{G(o)})},[Y,G]),z.createElement(re.Provider,{value:ee},z.createElement(ie.Provider,{value:f},z.createElement(ve,{value:_(f.comboboxState,{[0]:W.Open,[1]:W.Closed})},l!=null&&t!=null&&de({[l]:t}).map(([b,x],h)=>z.createElement(Oe,{features:Ce.Hidden,ref:h===0?Z=>{var le;Y.current=(le=Z==null?void 0:Z.closest("form"))!=null?le:null}:void 0,...xe({key:b,as:"input",type:"hidden",hidden:!0,readOnly:!0,name:b,value:x})})),B({ourProps:fe,theirProps:P,slot:D,defaultTag:ke,name:"Combobox"}))))}let Ne="input";function Be(e,n){var r,o,a,l;let i=H(),{id:v=`headlessui-combobox-input-${i}`,onChange:m,displayValue:s,type:O="text",...P}=e,t=V("Combobox.Input"),u=K("Combobox.Input"),I=U(t.inputRef,n),c=p.useRef(!1),R=te(),A=function(){var d;return typeof s=="function"&&t.value!==void 0?(d=s(t.value))!=null?d:"":typeof t.value=="string"?t.value:""}();se(([d,w],[y,q])=>{c.current||t.inputRef.current&&(q===0&&w===1||d!==y)&&(t.inputRef.current.value=d)},[A,t.comboboxState]),se(([d],[w])=>{if(d===0&&w===1){let y=t.inputRef.current;if(!y)return;let q=y.value,{selectionStart:J,selectionEnd:Q,selectionDirection:X}=y;y.value="",y.value=q,X!==null?y.setSelectionRange(J,Q,X):y.setSelectionRange(J,Q)}},[t.comboboxState]);let M=p.useRef(!1),j=g(()=>{M.current=!0}),F=g(()=>{setTimeout(()=>{M.current=!1})}),$=g(d=>{switch(c.current=!0,d.key){case T.Backspace:case T.Delete:if(t.mode!==0||!t.nullable)return;let w=d.currentTarget;R.requestAnimationFrame(()=>{w.value===""&&(u.onChange(null),t.optionsRef.current&&(t.optionsRef.current.scrollTop=0),u.goToOption(S.Nothing))});break;case T.Enter:if(c.current=!1,t.comboboxState!==0||M.current)return;if(d.preventDefault(),d.stopPropagation(),t.activeOptionIndex===null){u.closeCombobox();return}u.selectActiveOption(),t.mode===0&&u.closeCombobox();break;case T.ArrowDown:return c.current=!1,d.preventDefault(),d.stopPropagation(),_(t.comboboxState,{[0]:()=>{u.goToOption(S.Next)},[1]:()=>{u.openCombobox()}});case T.ArrowUp:return c.current=!1,d.preventDefault(),d.stopPropagation(),_(t.comboboxState,{[0]:()=>{u.goToOption(S.Previous)},[1]:()=>{u.openCombobox(),R.nextFrame(()=>{t.value||u.goToOption(S.Last)})}});case T.Home:if(d.shiftKey)break;return c.current=!1,d.preventDefault(),d.stopPropagation(),u.goToOption(S.First);case T.PageUp:return c.current=!1,d.preventDefault(),d.stopPropagation(),u.goToOption(S.First);case T.End:if(d.shiftKey)break;return c.current=!1,d.preventDefault(),d.stopPropagation(),u.goToOption(S.Last);case T.PageDown:return c.current=!1,d.preventDefault(),d.stopPropagation(),u.goToOption(S.Last);case T.Escape:return c.current=!1,t.comboboxState!==0?void 0:(d.preventDefault(),t.optionsRef.current&&!t.optionsPropsRef.current.static&&d.stopPropagation(),u.closeCombobox());case T.Tab:if(c.current=!1,t.comboboxState!==0)return;t.mode===0&&u.selectActiveOption(),u.closeCombobox();break}}),E=g(d=>{u.openCombobox(),m==null||m(d)}),k=g(()=>{c.current=!1}),f=ne(()=>{if(t.labelId)return[t.labelId].join(" ")},[t.labelId]),C=p.useMemo(()=>({open:t.comboboxState===0,disabled:t.disabled}),[t]),D={ref:I,id:v,role:"combobox",type:O,"aria-controls":(r=t.optionsRef.current)==null?void 0:r.id,"aria-expanded":t.disabled?void 0:t.comboboxState===0,"aria-activedescendant":t.activeOptionIndex===null||(o=t.options[t.activeOptionIndex])==null?void 0:o.id,"aria-labelledby":f,"aria-autocomplete":"list",defaultValue:(l=(a=e.defaultValue)!=null?a:t.defaultValue!==void 0?s==null?void 0:s(t.defaultValue):null)!=null?l:t.defaultValue,disabled:t.disabled,onCompositionStart:j,onCompositionEnd:F,onKeyDown:$,onChange:E,onBlur:k};return B({ourProps:D,theirProps:P,slot:C,defaultTag:Ne,name:"Combobox.Input"})}let Ve="button";function je(e,n){var r;let o=V("Combobox.Button"),a=K("Combobox.Button"),l=U(o.buttonRef,n),i=H(),{id:v=`headlessui-combobox-button-${i}`,...m}=e,s=te(),O=g(c=>{switch(c.key){case T.ArrowDown:return c.preventDefault(),c.stopPropagation(),o.comboboxState===1&&a.openCombobox(),s.nextFrame(()=>{var R;return(R=o.inputRef.current)==null?void 0:R.focus({preventScroll:!0})});case T.ArrowUp:return c.preventDefault(),c.stopPropagation(),o.comboboxState===1&&(a.openCombobox(),s.nextFrame(()=>{o.value||a.goToOption(S.Last)})),s.nextFrame(()=>{var R;return(R=o.inputRef.current)==null?void 0:R.focus({preventScroll:!0})});case T.Escape:return o.comboboxState!==0?void 0:(c.preventDefault(),o.optionsRef.current&&!o.optionsPropsRef.current.static&&c.stopPropagation(),a.closeCombobox(),s.nextFrame(()=>{var R;return(R=o.inputRef.current)==null?void 0:R.focus({preventScroll:!0})}));default:return}}),P=g(c=>{if(Ie(c.currentTarget))return c.preventDefault();o.comboboxState===0?a.closeCombobox():(c.preventDefault(),a.openCombobox()),s.nextFrame(()=>{var R;return(R=o.inputRef.current)==null?void 0:R.focus({preventScroll:!0})})}),t=ne(()=>{if(o.labelId)return[o.labelId,v].join(" ")},[o.labelId,v]),u=p.useMemo(()=>({open:o.comboboxState===0,disabled:o.disabled,value:o.value}),[o]),I={ref:l,id:v,type:he(e,o.buttonRef),tabIndex:-1,"aria-haspopup":"listbox","aria-controls":(r=o.optionsRef.current)==null?void 0:r.id,"aria-expanded":o.disabled?void 0:o.comboboxState===0,"aria-labelledby":t,disabled:o.disabled,onClick:P,onKeyDown:O};return B({ourProps:I,theirProps:m,slot:u,defaultTag:Ve,name:"Combobox.Button"})}let qe="label";function Ge(e,n){let r=H(),{id:o=`headlessui-combobox-label-${r}`,...a}=e,l=V("Combobox.Label"),i=K("Combobox.Label"),v=U(l.labelRef,n);L(()=>i.registerLabel(o),[o]);let m=g(()=>{var O;return(O=l.inputRef.current)==null?void 0:O.focus({preventScroll:!0})}),s=p.useMemo(()=>({open:l.comboboxState===0,disabled:l.disabled}),[l]);return B({ourProps:{ref:v,id:o,onClick:m},theirProps:a,slot:s,defaultTag:qe,name:"Combobox.Label"})}let Ue="ul",He=ae.RenderStrategy|ae.Static;function Ke(e,n){let r=H(),{id:o=`headlessui-combobox-options-${r}`,hold:a=!1,...l}=e,i=V("Combobox.Options"),v=U(i.optionsRef,n),m=ge(),s=(()=>m!==null?(m&W.Open)===W.Open:i.comboboxState===0)();L(()=>{var u;i.optionsPropsRef.current.static=(u=e.static)!=null?u:!1},[i.optionsPropsRef,e.static]),L(()=>{i.optionsPropsRef.current.hold=a},[i.optionsPropsRef,a]),Pe({container:i.optionsRef.current,enabled:i.comboboxState===0,accept(u){return u.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:u.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(u){u.setAttribute("role","none")}});let O=ne(()=>{var u,I;return(I=i.labelId)!=null?I:(u=i.buttonRef.current)==null?void 0:u.id},[i.labelId,i.buttonRef.current]),P=p.useMemo(()=>({open:i.comboboxState===0}),[i]),t={"aria-labelledby":O,role:"listbox","aria-multiselectable":i.mode===1?!0:void 0,id:o,ref:v};return B({ourProps:t,theirProps:l,slot:P,defaultTag:Ue,features:He,visible:s,name:"Combobox.Options"})}let Je="li";function Qe(e,n){var r,o;let a=H(),{id:l=`headlessui-combobox-option-${a}`,disabled:i=!1,value:v,...m}=e,s=V("Combobox.Option"),O=K("Combobox.Option"),P=s.activeOptionIndex!==null?s.options[s.activeOptionIndex].id===l:!1,t=s.isSelected(v),u=p.useRef(null),I=ce({disabled:i,value:v,domRef:u,textValue:(o=(r=u.current)==null?void 0:r.textContent)==null?void 0:o.toLowerCase()}),c=U(n,u),R=g(()=>O.selectOption(l));L(()=>O.registerOption(l,I),[I,l]);let A=p.useRef(!s.__demoMode);L(()=>{if(!s.__demoMode)return;let C=ue();return C.requestAnimationFrame(()=>{A.current=!0}),C.dispose},[]),L(()=>{if(s.comboboxState!==0||!P||!A.current||s.activationTrigger===0)return;let C=ue();return C.requestAnimationFrame(()=>{var D,d;(d=(D=u.current)==null?void 0:D.scrollIntoView)==null||d.call(D,{block:"nearest"})}),C.dispose},[u,P,s.comboboxState,s.activationTrigger,s.activeOptionIndex]);let M=g(C=>{if(i)return C.preventDefault();R(),s.mode===0&&O.closeCombobox(),De()||requestAnimationFrame(()=>{var D;return(D=s.inputRef.current)==null?void 0:D.focus()})}),j=g(()=>{if(i)return O.goToOption(S.Nothing);O.goToOption(S.Specific,l)}),F=Te(),$=g(C=>F.update(C)),E=g(C=>{F.wasMoved(C)&&(i||P||O.goToOption(S.Specific,l,0))}),k=g(C=>{F.wasMoved(C)&&(i||P&&(s.optionsPropsRef.current.hold||O.goToOption(S.Nothing)))}),f=p.useMemo(()=>({active:P,selected:t,disabled:i}),[P,t,i]);return B({ourProps:{id:l,ref:c,role:"option",tabIndex:i===!0?void 0:-1,"aria-disabled":i===!0?!0:void 0,"aria-selected":t,disabled:void 0,onClick:M,onFocus:j,onPointerEnter:$,onMouseEnter:$,onPointerMove:E,onMouseMove:E,onPointerLeave:k,onMouseLeave:k},theirProps:m,slot:f,defaultTag:Je,name:"Combobox.Option"})}let Xe=N(_e),Ye=N(je),Ze=N(Be),ze=N(Ge),We=N(Ke),eo=N(Qe),ao=Object.assign(Xe,{Input:Ze,Button:Ye,Label:ze,Options:We,Option:eo});export{ao as J};
//# sourceMappingURL=combobox-00d1fd7e.js.map
