import{r as u,R as O}from"./index-580b8df0.js";import{l as X,j as J,L as W,y as K,T as ve,s as ue,o as y,c as fe,u as A,d as H,D as U,C as se}from"./transition-df23ef1c.js";import{n as Z,E as ee,a as Pe,L as be,I as j,b as ie,c as Y,p as _,d as N,f as R,h as me,F as Se,o as G,r as pe,e as ye,s as L,N as z}from"./use-event-listener-472363b9.js";function ae(e){var n;if(e.type)return e.type;let s=(n=e.as)!=null?n:"button";if(typeof s=="string"&&s.toLowerCase()==="button")return"button"}function Ee(e,n){let[s,b]=u.useState(()=>ae(e));return X(()=>{b(ae(e))},[e.type,e.as]),X(()=>{s||n.current&&n.current instanceof HTMLButtonElement&&!n.current.hasAttribute("type")&&b("button")},[s,n]),s}var ge=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ge||{}),Ie=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(Ie||{});let he={[0]:e=>({...e,popoverState:A(e.popoverState,{[0]:1,[1]:0})}),[1](e){return e.popoverState===1?e:{...e,popoverState:1}},[2](e,n){return e.button===n.button?e:{...e,button:n.button}},[3](e,n){return e.buttonId===n.buttonId?e:{...e,buttonId:n.buttonId}},[4](e,n){return e.panel===n.panel?e:{...e,panel:n.panel}},[5](e,n){return e.panelId===n.panelId?e:{...e,panelId:n.panelId}}},te=u.createContext(null);te.displayName="PopoverContext";function Q(e){let n=u.useContext(te);if(n===null){let s=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,Q),s}return n}let ne=u.createContext(null);ne.displayName="PopoverAPIContext";function re(e){let n=u.useContext(ne);if(n===null){let s=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,re),s}return n}let oe=u.createContext(null);oe.displayName="PopoverGroupContext";function ce(){return u.useContext(oe)}let le=u.createContext(null);le.displayName="PopoverPanelContext";function $e(){return u.useContext(le)}function Ce(e,n){return A(n.type,he,e,n)}let xe="div";function Fe(e,n){var s;let b=u.useRef(null),$=K(n,ve(t=>{b.current=t})),o=u.useRef([]),r=u.useReducer(Ce,{popoverState:1,buttons:o,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:u.createRef(),afterPanelSentinel:u.createRef()}),[{popoverState:v,button:a,buttonId:C,panel:P,panelId:E,beforePanelSentinel:d,afterPanelSentinel:g},c]=r,i=Z((s=b.current)!=null?s:a),S=u.useMemo(()=>{if(!a||!P)return!1;for(let q of document.querySelectorAll("body > *"))if(Number(q==null?void 0:q.contains(a))^Number(q==null?void 0:q.contains(P)))return!0;let t=ee(),l=t.indexOf(a),m=(l+t.length-1)%t.length,F=(l+1)%t.length,V=t[m],de=t[F];return!P.contains(V)&&!P.contains(de)},[a,P]),I=ue(C),w=ue(E),k=u.useMemo(()=>({buttonId:I,panelId:w,close:()=>c({type:1})}),[I,w,c]),T=ce(),D=T==null?void 0:T.registerPopover,M=y(()=>{var t;return(t=T==null?void 0:T.isFocusWithinPopoverGroup())!=null?t:(i==null?void 0:i.activeElement)&&((a==null?void 0:a.contains(i.activeElement))||(P==null?void 0:P.contains(i.activeElement)))});u.useEffect(()=>D==null?void 0:D(k),[D,k]),Pe(i==null?void 0:i.defaultView,"focus",t=>{var l,m,F,V;v===0&&(M()||a&&P&&t.target!==window&&((m=(l=d.current)==null?void 0:l.contains)!=null&&m.call(l,t.target)||(V=(F=g.current)==null?void 0:F.contains)!=null&&V.call(F,t.target)||c({type:1})))},!0),be([a,P],(t,l)=>{c({type:1}),me(l,Se.Loose)||(t.preventDefault(),a==null||a.focus())},v===0);let p=y(t=>{c({type:1});let l=(()=>t?t instanceof HTMLElement?t:"current"in t&&t.current instanceof HTMLElement?t.current:a:a)();l==null||l.focus()}),h=u.useMemo(()=>({close:p,isPortalled:S}),[p,S]),f=u.useMemo(()=>({open:v===0,close:p}),[v,p]),x=e,B={ref:$};return O.createElement(te.Provider,{value:r},O.createElement(ne.Provider,{value:h},O.createElement(fe,{value:A(v,{[0]:H.Open,[1]:H.Closed})},U({ourProps:B,theirProps:x,slot:f,defaultTag:xe,name:"Popover"}))))}let we="button";function Te(e,n){let s=j(),{id:b=`headlessui-popover-button-${s}`,...$}=e,[o,r]=Q("Popover.Button"),{isPortalled:v}=re("Popover.Button"),a=u.useRef(null),C=`headlessui-focus-sentinel-${j()}`,P=ce(),E=P==null?void 0:P.closeOthers,d=$e(),g=d===null?!1:d===o.panelId;u.useEffect(()=>{if(!g)return r({type:3,buttonId:b}),()=>{r({type:3,buttonId:null})}},[g,b,r]);let[c]=u.useState(()=>Symbol()),i=K(a,n,g?null:t=>{if(t)o.buttons.current.push(c);else{let l=o.buttons.current.indexOf(c);l!==-1&&o.buttons.current.splice(l,1)}o.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),t&&r({type:2,button:t})}),S=K(a,n),I=Z(a),w=y(t=>{var l,m,F;if(g){if(o.popoverState===1)return;switch(t.key){case G.Space:case G.Enter:t.preventDefault(),(m=(l=t.target).click)==null||m.call(l),r({type:1}),(F=o.button)==null||F.focus();break}}else switch(t.key){case G.Space:case G.Enter:t.preventDefault(),t.stopPropagation(),o.popoverState===1&&(E==null||E(o.buttonId)),r({type:0});break;case G.Escape:if(o.popoverState!==0)return E==null?void 0:E(o.buttonId);if(!a.current||I!=null&&I.activeElement&&!a.current.contains(I.activeElement))return;t.preventDefault(),t.stopPropagation(),r({type:1});break}}),k=y(t=>{g||t.key===G.Space&&t.preventDefault()}),T=y(t=>{var l,m;pe(t.currentTarget)||e.disabled||(g?(r({type:1}),(l=o.button)==null||l.focus()):(t.preventDefault(),t.stopPropagation(),o.popoverState===1&&(E==null||E(o.buttonId)),r({type:0}),(m=o.button)==null||m.focus()))}),D=y(t=>{t.preventDefault(),t.stopPropagation()}),M=o.popoverState===0,p=u.useMemo(()=>({open:M}),[M]),h=Ee(e,a),f=g?{ref:S,type:h,onKeyDown:w,onClick:T}:{ref:i,id:o.buttonId,type:h,"aria-expanded":e.disabled?void 0:o.popoverState===0,"aria-controls":o.panel?o.panelId:void 0,onKeyDown:w,onKeyUp:k,onClick:T,onMouseDown:D},x=ie(),B=y(()=>{let t=o.panel;if(!t)return;function l(){A(x.current,{[L.Forwards]:()=>N(t,R.First),[L.Backwards]:()=>N(t,R.Last)})===z.Error&&N(ee().filter(m=>m.dataset.headlessuiFocusGuard!=="true"),A(x.current,{[L.Forwards]:R.Next,[L.Backwards]:R.Previous}),{relativeTo:o.button})}l()});return O.createElement(O.Fragment,null,U({ourProps:f,theirProps:$,slot:p,defaultTag:we,name:"Popover.Button"}),M&&!g&&v&&O.createElement(Y,{id:C,features:_.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:B}))}let Be="div",Oe=J.RenderStrategy|J.Static;function ke(e,n){let s=j(),{id:b=`headlessui-popover-overlay-${s}`,...$}=e,[{popoverState:o},r]=Q("Popover.Overlay"),v=K(n),a=se(),C=(()=>a!==null?(a&H.Open)===H.Open:o===0)(),P=y(d=>{if(pe(d.currentTarget))return d.preventDefault();r({type:1})}),E=u.useMemo(()=>({open:o===0}),[o]);return U({ourProps:{ref:v,id:b,"aria-hidden":!0,onClick:P},theirProps:$,slot:E,defaultTag:Be,features:Oe,visible:C,name:"Popover.Overlay"})}let Re="div",Le=J.RenderStrategy|J.Static;function De(e,n){let s=j(),{id:b=`headlessui-popover-panel-${s}`,focus:$=!1,...o}=e,[r,v]=Q("Popover.Panel"),{close:a,isPortalled:C}=re("Popover.Panel"),P=`headlessui-focus-sentinel-before-${j()}`,E=`headlessui-focus-sentinel-after-${j()}`,d=u.useRef(null),g=K(d,n,p=>{v({type:4,panel:p})}),c=Z(d);X(()=>(v({type:5,panelId:b}),()=>{v({type:5,panelId:null})}),[b,v]);let i=se(),S=(()=>i!==null?(i&H.Open)===H.Open:r.popoverState===0)(),I=y(p=>{var h;switch(p.key){case G.Escape:if(r.popoverState!==0||!d.current||c!=null&&c.activeElement&&!d.current.contains(c.activeElement))return;p.preventDefault(),p.stopPropagation(),v({type:1}),(h=r.button)==null||h.focus();break}});u.useEffect(()=>{var p;e.static||r.popoverState===1&&((p=e.unmount)==null||p)&&v({type:4,panel:null})},[r.popoverState,e.unmount,e.static,v]),u.useEffect(()=>{if(!$||r.popoverState!==0||!d.current)return;let p=c==null?void 0:c.activeElement;d.current.contains(p)||N(d.current,R.First)},[$,d,r.popoverState]);let w=u.useMemo(()=>({open:r.popoverState===0,close:a}),[r,a]),k={ref:g,id:b,onKeyDown:I,onBlur:$&&r.popoverState===0?p=>{var h,f,x,B,t;let l=p.relatedTarget;l&&d.current&&((h=d.current)!=null&&h.contains(l)||(v({type:1}),((x=(f=r.beforePanelSentinel.current)==null?void 0:f.contains)!=null&&x.call(f,l)||(t=(B=r.afterPanelSentinel.current)==null?void 0:B.contains)!=null&&t.call(B,l))&&l.focus({preventScroll:!0})))}:void 0,tabIndex:-1},T=ie(),D=y(()=>{let p=d.current;if(!p)return;function h(){A(T.current,{[L.Forwards]:()=>{var f;N(p,R.First)===z.Error&&((f=r.afterPanelSentinel.current)==null||f.focus())},[L.Backwards]:()=>{var f;(f=r.button)==null||f.focus({preventScroll:!0})}})}h()}),M=y(()=>{let p=d.current;if(!p)return;function h(){A(T.current,{[L.Forwards]:()=>{var f;if(!r.button)return;let x=ee(),B=x.indexOf(r.button),t=x.slice(0,B+1),l=[...x.slice(B+1),...t];for(let m of l.slice())if(m.dataset.headlessuiFocusGuard==="true"||(f=r.panel)!=null&&f.contains(m)){let F=l.indexOf(m);F!==-1&&l.splice(F,1)}N(l,R.First,{sorted:!1})},[L.Backwards]:()=>{var f;N(p,R.Previous)===z.Error&&((f=r.button)==null||f.focus())}})}h()});return O.createElement(le.Provider,{value:b},S&&C&&O.createElement(Y,{id:P,ref:r.beforePanelSentinel,features:_.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:D}),U({ourProps:k,theirProps:o,slot:w,defaultTag:Re,features:Le,visible:S,name:"Popover.Panel"}),S&&C&&O.createElement(Y,{id:E,ref:r.afterPanelSentinel,features:_.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:M}))}let Me="div";function Ge(e,n){let s=u.useRef(null),b=K(s,n),[$,o]=u.useState([]),r=y(c=>{o(i=>{let S=i.indexOf(c);if(S!==-1){let I=i.slice();return I.splice(S,1),I}return i})}),v=y(c=>(o(i=>[...i,c]),()=>r(c))),a=y(()=>{var c;let i=ye(s);if(!i)return!1;let S=i.activeElement;return(c=s.current)!=null&&c.contains(S)?!0:$.some(I=>{var w,k;return((w=i.getElementById(I.buttonId.current))==null?void 0:w.contains(S))||((k=i.getElementById(I.panelId.current))==null?void 0:k.contains(S))})}),C=y(c=>{for(let i of $)i.buttonId.current!==c&&i.close()}),P=u.useMemo(()=>({registerPopover:v,unregisterPopover:r,isFocusWithinPopoverGroup:a,closeOthers:C}),[v,r,a,C]),E=u.useMemo(()=>({}),[]),d=e,g={ref:b};return O.createElement(oe.Provider,{value:P},U({ourProps:g,theirProps:d,slot:E,defaultTag:Me,name:"Popover.Group"}))}let Ne=W(Fe),Ae=W(Te),je=W(ke),Ke=W(De),He=W(Ge),qe=Object.assign(Ne,{Button:Ae,Overlay:je,Panel:Ke,Group:He});export{qe as L,Ee as s};
//# sourceMappingURL=popover-2558df07.js.map
