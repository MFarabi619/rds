import{r as u,R as O}from"./index-580b8df0.js";import{j as J,L as W,y as K,T as ce,s as le,o as S,c as de,u as A,d as H,D as U,C as ue,l as ve}from"./open-closed-6ab898d8.js";import{E as z,L as fe,I as j,c as X,p as Y,a as N,b as R,h as Pe,F as be,o as G,r as ae,e as me,N as _}from"./keyboard-46ff6cb9.js";import{s as Se}from"./use-resolve-button-type-6b4df908.js";import{n as Z,E as ye,a as se,s as D}from"./use-event-listener-a3eb1d61.js";var Ee=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Ee||{}),ge=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(ge||{});let Ie={[0]:e=>({...e,popoverState:A(e.popoverState,{[0]:1,[1]:0})}),[1](e){return e.popoverState===1?e:{...e,popoverState:1}},[2](e,l){return e.button===l.button?e:{...e,button:l.button}},[3](e,l){return e.buttonId===l.buttonId?e:{...e,buttonId:l.buttonId}},[4](e,l){return e.panel===l.panel?e:{...e,panel:l.panel}},[5](e,l){return e.panelId===l.panelId?e:{...e,panelId:l.panelId}}},ee=u.createContext(null);ee.displayName="PopoverContext";function Q(e){let l=u.useContext(ee);if(l===null){let f=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(f,Q),f}return l}let te=u.createContext(null);te.displayName="PopoverAPIContext";function ne(e){let l=u.useContext(te);if(l===null){let f=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(f,ne),f}return l}let re=u.createContext(null);re.displayName="PopoverGroupContext";function ie(){return u.useContext(re)}let oe=u.createContext(null);oe.displayName="PopoverPanelContext";function $e(){return u.useContext(oe)}function he(e,l){return A(l.type,Ie,e,l)}let xe="div";function Ce(e,l){var f;let y=u.useRef(null),h=K(l,ce(t=>{y.current=t})),r=u.useRef([]),n=u.useReducer(he,{popoverState:1,buttons:r,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:u.createRef(),afterPanelSentinel:u.createRef()}),[{popoverState:d,button:a,buttonId:x,panel:P,panelId:E,beforePanelSentinel:c,afterPanelSentinel:g},p]=n,s=Z((f=y.current)!=null?f:a),m=u.useMemo(()=>{if(!a||!P)return!1;for(let q of document.querySelectorAll("body > *"))if(Number(q==null?void 0:q.contains(a))^Number(q==null?void 0:q.contains(P)))return!0;let t=z(),o=t.indexOf(a),b=(o+t.length-1)%t.length,F=(o+1)%t.length,V=t[b],pe=t[F];return!P.contains(V)&&!P.contains(pe)},[a,P]),I=le(x),w=le(E),k=u.useMemo(()=>({buttonId:I,panelId:w,close:()=>p({type:1})}),[I,w,p]),T=ie(),L=T==null?void 0:T.registerPopover,M=S(()=>{var t;return(t=T==null?void 0:T.isFocusWithinPopoverGroup())!=null?t:(s==null?void 0:s.activeElement)&&((a==null?void 0:a.contains(s.activeElement))||(P==null?void 0:P.contains(s.activeElement)))});u.useEffect(()=>L==null?void 0:L(k),[L,k]),ye(s==null?void 0:s.defaultView,"focus",t=>{var o,b,F,V;d===0&&(M()||a&&P&&t.target!==window&&((b=(o=c.current)==null?void 0:o.contains)!=null&&b.call(o,t.target)||(V=(F=g.current)==null?void 0:F.contains)!=null&&V.call(F,t.target)||p({type:1})))},!0),fe([a,P],(t,o)=>{p({type:1}),Pe(o,be.Loose)||(t.preventDefault(),a==null||a.focus())},d===0);let i=S(t=>{p({type:1});let o=(()=>t?t instanceof HTMLElement?t:"current"in t&&t.current instanceof HTMLElement?t.current:a:a)();o==null||o.focus()}),$=u.useMemo(()=>({close:i,isPortalled:m}),[i,m]),v=u.useMemo(()=>({open:d===0,close:i}),[d,i]),C=e,B={ref:h};return O.createElement(ee.Provider,{value:n},O.createElement(te.Provider,{value:$},O.createElement(de,{value:A(d,{[0]:H.Open,[1]:H.Closed})},U({ourProps:B,theirProps:C,slot:v,defaultTag:xe,name:"Popover"}))))}let Fe="button";function we(e,l){let f=j(),{id:y=`headlessui-popover-button-${f}`,...h}=e,[r,n]=Q("Popover.Button"),{isPortalled:d}=ne("Popover.Button"),a=u.useRef(null),x=`headlessui-focus-sentinel-${j()}`,P=ie(),E=P==null?void 0:P.closeOthers,c=$e(),g=c===null?!1:c===r.panelId;u.useEffect(()=>{if(!g)return n({type:3,buttonId:y}),()=>{n({type:3,buttonId:null})}},[g,y,n]);let[p]=u.useState(()=>Symbol()),s=K(a,l,g?null:t=>{if(t)r.buttons.current.push(p);else{let o=r.buttons.current.indexOf(p);o!==-1&&r.buttons.current.splice(o,1)}r.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),t&&n({type:2,button:t})}),m=K(a,l),I=Z(a),w=S(t=>{var o,b,F;if(g){if(r.popoverState===1)return;switch(t.key){case G.Space:case G.Enter:t.preventDefault(),(b=(o=t.target).click)==null||b.call(o),n({type:1}),(F=r.button)==null||F.focus();break}}else switch(t.key){case G.Space:case G.Enter:t.preventDefault(),t.stopPropagation(),r.popoverState===1&&(E==null||E(r.buttonId)),n({type:0});break;case G.Escape:if(r.popoverState!==0)return E==null?void 0:E(r.buttonId);if(!a.current||I!=null&&I.activeElement&&!a.current.contains(I.activeElement))return;t.preventDefault(),t.stopPropagation(),n({type:1});break}}),k=S(t=>{g||t.key===G.Space&&t.preventDefault()}),T=S(t=>{var o,b;ae(t.currentTarget)||e.disabled||(g?(n({type:1}),(o=r.button)==null||o.focus()):(t.preventDefault(),t.stopPropagation(),r.popoverState===1&&(E==null||E(r.buttonId)),n({type:0}),(b=r.button)==null||b.focus()))}),L=S(t=>{t.preventDefault(),t.stopPropagation()}),M=r.popoverState===0,i=u.useMemo(()=>({open:M}),[M]),$=Se(e,a),v=g?{ref:m,type:$,onKeyDown:w,onClick:T}:{ref:s,id:r.buttonId,type:$,"aria-expanded":e.disabled?void 0:r.popoverState===0,"aria-controls":r.panel?r.panelId:void 0,onKeyDown:w,onKeyUp:k,onClick:T,onMouseDown:L},C=se(),B=S(()=>{let t=r.panel;if(!t)return;function o(){A(C.current,{[D.Forwards]:()=>N(t,R.First),[D.Backwards]:()=>N(t,R.Last)})===_.Error&&N(z().filter(b=>b.dataset.headlessuiFocusGuard!=="true"),A(C.current,{[D.Forwards]:R.Next,[D.Backwards]:R.Previous}),{relativeTo:r.button})}o()});return O.createElement(O.Fragment,null,U({ourProps:v,theirProps:h,slot:i,defaultTag:Fe,name:"Popover.Button"}),M&&!g&&d&&O.createElement(X,{id:x,features:Y.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:B}))}let Te="div",Be=J.RenderStrategy|J.Static;function Oe(e,l){let f=j(),{id:y=`headlessui-popover-overlay-${f}`,...h}=e,[{popoverState:r},n]=Q("Popover.Overlay"),d=K(l),a=ue(),x=(()=>a!==null?(a&H.Open)===H.Open:r===0)(),P=S(c=>{if(ae(c.currentTarget))return c.preventDefault();n({type:1})}),E=u.useMemo(()=>({open:r===0}),[r]);return U({ourProps:{ref:d,id:y,"aria-hidden":!0,onClick:P},theirProps:h,slot:E,defaultTag:Te,features:Be,visible:x,name:"Popover.Overlay"})}let ke="div",Re=J.RenderStrategy|J.Static;function De(e,l){let f=j(),{id:y=`headlessui-popover-panel-${f}`,focus:h=!1,...r}=e,[n,d]=Q("Popover.Panel"),{close:a,isPortalled:x}=ne("Popover.Panel"),P=`headlessui-focus-sentinel-before-${j()}`,E=`headlessui-focus-sentinel-after-${j()}`,c=u.useRef(null),g=K(c,l,i=>{d({type:4,panel:i})}),p=Z(c);ve(()=>(d({type:5,panelId:y}),()=>{d({type:5,panelId:null})}),[y,d]);let s=ue(),m=(()=>s!==null?(s&H.Open)===H.Open:n.popoverState===0)(),I=S(i=>{var $;switch(i.key){case G.Escape:if(n.popoverState!==0||!c.current||p!=null&&p.activeElement&&!c.current.contains(p.activeElement))return;i.preventDefault(),i.stopPropagation(),d({type:1}),($=n.button)==null||$.focus();break}});u.useEffect(()=>{var i;e.static||n.popoverState===1&&((i=e.unmount)==null||i)&&d({type:4,panel:null})},[n.popoverState,e.unmount,e.static,d]),u.useEffect(()=>{if(!h||n.popoverState!==0||!c.current)return;let i=p==null?void 0:p.activeElement;c.current.contains(i)||N(c.current,R.First)},[h,c,n.popoverState]);let w=u.useMemo(()=>({open:n.popoverState===0,close:a}),[n,a]),k={ref:g,id:y,onKeyDown:I,onBlur:h&&n.popoverState===0?i=>{var $,v,C,B,t;let o=i.relatedTarget;o&&c.current&&(($=c.current)!=null&&$.contains(o)||(d({type:1}),((C=(v=n.beforePanelSentinel.current)==null?void 0:v.contains)!=null&&C.call(v,o)||(t=(B=n.afterPanelSentinel.current)==null?void 0:B.contains)!=null&&t.call(B,o))&&o.focus({preventScroll:!0})))}:void 0,tabIndex:-1},T=se(),L=S(()=>{let i=c.current;if(!i)return;function $(){A(T.current,{[D.Forwards]:()=>{var v;N(i,R.First)===_.Error&&((v=n.afterPanelSentinel.current)==null||v.focus())},[D.Backwards]:()=>{var v;(v=n.button)==null||v.focus({preventScroll:!0})}})}$()}),M=S(()=>{let i=c.current;if(!i)return;function $(){A(T.current,{[D.Forwards]:()=>{var v;if(!n.button)return;let C=z(),B=C.indexOf(n.button),t=C.slice(0,B+1),o=[...C.slice(B+1),...t];for(let b of o.slice())if(b.dataset.headlessuiFocusGuard==="true"||(v=n.panel)!=null&&v.contains(b)){let F=o.indexOf(b);F!==-1&&o.splice(F,1)}N(o,R.First,{sorted:!1})},[D.Backwards]:()=>{var v;N(i,R.Previous)===_.Error&&((v=n.button)==null||v.focus())}})}$()});return O.createElement(oe.Provider,{value:y},m&&x&&O.createElement(X,{id:P,ref:n.beforePanelSentinel,features:Y.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:L}),U({ourProps:k,theirProps:r,slot:w,defaultTag:ke,features:Re,visible:m,name:"Popover.Panel"}),m&&x&&O.createElement(X,{id:E,ref:n.afterPanelSentinel,features:Y.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:M}))}let Le="div";function Me(e,l){let f=u.useRef(null),y=K(f,l),[h,r]=u.useState([]),n=S(p=>{r(s=>{let m=s.indexOf(p);if(m!==-1){let I=s.slice();return I.splice(m,1),I}return s})}),d=S(p=>(r(s=>[...s,p]),()=>n(p))),a=S(()=>{var p;let s=me(f);if(!s)return!1;let m=s.activeElement;return(p=f.current)!=null&&p.contains(m)?!0:h.some(I=>{var w,k;return((w=s.getElementById(I.buttonId.current))==null?void 0:w.contains(m))||((k=s.getElementById(I.panelId.current))==null?void 0:k.contains(m))})}),x=S(p=>{for(let s of h)s.buttonId.current!==p&&s.close()}),P=u.useMemo(()=>({registerPopover:d,unregisterPopover:n,isFocusWithinPopoverGroup:a,closeOthers:x}),[d,n,a,x]),E=u.useMemo(()=>({}),[]),c=e,g={ref:y};return O.createElement(re.Provider,{value:P},U({ourProps:g,theirProps:c,slot:E,defaultTag:Le,name:"Popover.Group"}))}let Ge=W(Ce),Ne=W(we),Ae=W(Oe),je=W(De),Ke=W(Me),Je=Object.assign(Ge,{Button:Ne,Overlay:Ae,Panel:je,Group:Ke});export{Je as L};
//# sourceMappingURL=popover-761b7829.js.map
