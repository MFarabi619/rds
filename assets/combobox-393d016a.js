import{r as d,R as z}from"./index-ec8b93d8.js";import{s as de,l as M,o as g,S as ue,D as V,u as N,p as ne,c as xe,d as ee,R as ge,X as B,y as X,C as Re,a as se}from"./open-closed-aa2934ca.js";import{H as Oe,c as Ce,p as Ie,I as G,o as T,r as Se,a as he}from"./keyboard-0f6663c0.js";import{s as Te}from"./use-resolve-button-type-b6561d60.js";import{F as Pe,u as ye,a as I,x as Ee}from"./use-tracked-pointer-7104e2e3.js";import{m as ce,n as De}from"./platform-42294b71.js";function re(e,t){let[n,o]=d.useState(e),l=de(e);return M(()=>o(l.current),[l,o,...t]),n}function pe(e={},t=null,n=[]){for(let[o,l]of Object.entries(e))fe(n,be(t,o),l);return n}function be(e,t){return e?e+"["+t+"]":t}function fe(e,t,n){if(Array.isArray(n))for(let[o,l]of n.entries())fe(e,be(t,o.toString()),l);else n instanceof Date?e.push([t,n.toISOString()]):typeof n=="boolean"?e.push([t,n?"1":"0"]):typeof n=="string"?e.push([t,n]):typeof n=="number"?e.push([t,`${n}`]):n==null?e.push([t,""]):pe(n,t,e)}function we(e,t,n){let[o,l]=d.useState(n),u=e!==void 0,i=d.useRef(u),R=d.useRef(!1),m=d.useRef(!1);return u&&!i.current&&!R.current?(R.current=!0,i.current=u,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!u&&i.current&&!m.current&&(m.current=!0,i.current=u,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[u?e:o,g(c=>(u||l(c),t==null?void 0:t(c)))]}var Ae=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Ae||{}),Me=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(Me||{}),Fe=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Fe||{}),ke=(e=>(e[e.OpenCombobox=0]="OpenCombobox",e[e.CloseCombobox=1]="CloseCombobox",e[e.GoToOption=2]="GoToOption",e[e.RegisterOption=3]="RegisterOption",e[e.UnregisterOption=4]="UnregisterOption",e[e.RegisterLabel=5]="RegisterLabel",e))(ke||{});function te(e,t=n=>n){let n=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,o=he(t(e.options.slice()),u=>u.dataRef.current.domRef.current),l=n?o.indexOf(n):null;return l===-1&&(l=null),{options:o,activeOptionIndex:l}}let Le={[1](e){var t;return(t=e.dataRef.current)!=null&&t.disabled||e.comboboxState===1?e:{...e,activeOptionIndex:null,comboboxState:1}},[0](e){var t;if((t=e.dataRef.current)!=null&&t.disabled||e.comboboxState===0)return e;let n=e.activeOptionIndex;if(e.dataRef.current){let{isSelected:o}=e.dataRef.current,l=e.options.findIndex(u=>o(u.dataRef.current.value));l!==-1&&(n=l)}return{...e,comboboxState:0,activeOptionIndex:n}},[2](e,t){var n,o,l,u;if((n=e.dataRef.current)!=null&&n.disabled||(o=e.dataRef.current)!=null&&o.optionsRef.current&&!((l=e.dataRef.current)!=null&&l.optionsPropsRef.current.static)&&e.comboboxState===1)return e;let i=te(e);if(i.activeOptionIndex===null){let m=i.options.findIndex(c=>!c.dataRef.current.disabled);m!==-1&&(i.activeOptionIndex=m)}let R=Ee(t,{resolveItems:()=>i.options,resolveActiveIndex:()=>i.activeOptionIndex,resolveId:m=>m.id,resolveDisabled:m=>m.dataRef.current.disabled});return{...e,...i,activeOptionIndex:R,activationTrigger:(u=t.trigger)!=null?u:1}},[3]:(e,t)=>{var n,o;let l={id:t.id,dataRef:t.dataRef},u=te(e,R=>[...R,l]);e.activeOptionIndex===null&&(n=e.dataRef.current)!=null&&n.isSelected(t.dataRef.current.value)&&(u.activeOptionIndex=u.options.indexOf(l));let i={...e,...u,activationTrigger:1};return(o=e.dataRef.current)!=null&&o.__demoMode&&e.dataRef.current.value===void 0&&(i.activeOptionIndex=0),i},[4]:(e,t)=>{let n=te(e,o=>{let l=o.findIndex(u=>u.id===t.id);return l!==-1&&o.splice(l,1),o});return{...e,...n,activationTrigger:1}},[5]:(e,t)=>({...e,labelId:t.id})},ie=d.createContext(null);ie.displayName="ComboboxActionsContext";function H(e){let t=d.useContext(ie);if(t===null){let n=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,H),n}return t}let ae=d.createContext(null);ae.displayName="ComboboxDataContext";function j(e){let t=d.useContext(ae);if(t===null){let n=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,j),n}return t}function $e(e,t){return N(t.type,Le,e,t)}let _e=d.Fragment;function Ne(e,t){let{value:n,defaultValue:o,onChange:l,form:u,name:i,by:R=(f,x)=>f===x,disabled:m=!1,__demoMode:c=!1,nullable:O=!1,multiple:C=!1,...r}=e,[a=C?[]:void 0,h]=we(n,l,o),[p,v]=d.useReducer($e,{dataRef:d.createRef(),comboboxState:c?0:1,options:[],activeOptionIndex:null,activationTrigger:1,labelId:null}),E=d.useRef(!1),w=d.useRef({static:!1,hold:!1}),A=d.useRef(null),F=d.useRef(null),L=d.useRef(null),$=d.useRef(null),D=g(typeof R=="string"?(f,x)=>{let S=R;return(f==null?void 0:f[S])===(x==null?void 0:x[S])}:R),q=d.useCallback(f=>N(s.mode,{[1]:()=>a.some(x=>D(x,f)),[0]:()=>D(a,f)}),[a]),s=d.useMemo(()=>({...p,optionsPropsRef:w,labelRef:A,inputRef:F,buttonRef:L,optionsRef:$,value:a,defaultValue:o,disabled:m,mode:C?1:0,get activeOptionIndex(){if(E.current&&p.activeOptionIndex===null&&p.options.length>0){let f=p.options.findIndex(x=>!x.dataRef.current.disabled);if(f!==-1)return f}return p.activeOptionIndex},compare:D,isSelected:q,nullable:O,__demoMode:c}),[a,o,m,C,O,c,p]),P=d.useRef(s.activeOptionIndex!==null?s.options[s.activeOptionIndex]:null);d.useEffect(()=>{let f=s.activeOptionIndex!==null?s.options[s.activeOptionIndex]:null;P.current!==f&&(P.current=f)}),M(()=>{p.dataRef.current=s},[s]),Oe([s.buttonRef,s.inputRef,s.optionsRef],()=>oe.closeCombobox(),s.comboboxState===0);let _=d.useMemo(()=>({open:s.comboboxState===0,disabled:m,activeIndex:s.activeOptionIndex,activeOption:s.activeOptionIndex===null?null:s.options[s.activeOptionIndex].dataRef.current.value,value:a}),[s,m,a]),b=g(f=>{let x=s.options.find(S=>S.id===f);x&&K(x.dataRef.current.value)}),k=g(()=>{if(s.activeOptionIndex!==null){let{dataRef:f,id:x}=s.options[s.activeOptionIndex];K(f.current.value),oe.goToOption(I.Specific,x)}}),y=g(()=>{v({type:0}),E.current=!0}),U=g(()=>{v({type:1}),E.current=!1}),J=g((f,x,S)=>(E.current=!1,f===I.Specific?v({type:2,focus:I.Specific,id:x,trigger:S}):v({type:2,focus:f,trigger:S}))),Q=g((f,x)=>(v({type:3,id:f,dataRef:x}),()=>{var S;((S=P.current)==null?void 0:S.id)===f&&(E.current=!0),v({type:4,id:f})})),W=g(f=>(v({type:5,id:f}),()=>v({type:5,id:null}))),K=g(f=>N(s.mode,{[0](){return h==null?void 0:h(f)},[1](){let x=s.value.slice(),S=x.findIndex(Z=>D(Z,f));return S===-1?x.push(f):x.splice(S,1),h==null?void 0:h(x)}})),oe=d.useMemo(()=>({onChange:K,registerOption:Q,registerLabel:W,goToOption:J,closeCombobox:U,openCombobox:y,selectActiveOption:k,selectOption:b}),[]),me=t===null?{}:{ref:t},Y=d.useRef(null),ve=ne();return d.useEffect(()=>{Y.current&&o!==void 0&&ve.addEventListener(Y.current,"reset",()=>{K(o)})},[Y,K]),z.createElement(ie.Provider,{value:oe},z.createElement(ae.Provider,{value:s},z.createElement(xe,{value:N(s.comboboxState,{[0]:ee.Open,[1]:ee.Closed})},i!=null&&a!=null&&pe({[i]:a}).map(([f,x],S)=>z.createElement(Ce,{features:Ie.Hidden,ref:S===0?Z=>{var le;Y.current=(le=Z==null?void 0:Z.closest("form"))!=null?le:null}:void 0,...ge({key:f,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:u,name:f,value:x})})),B({ourProps:me,theirProps:r,slot:_,defaultTag:_e,name:"Combobox"}))))}let Ve="input";function Be(e,t){var n,o,l,u;let i=G(),{id:R=`headlessui-combobox-input-${i}`,onChange:m,displayValue:c,type:O="text",...C}=e,r=j("Combobox.Input"),a=H("Combobox.Input"),h=X(r.inputRef,t),p=d.useRef(!1),v=ne(),E=function(){var b;return typeof c=="function"&&r.value!==void 0?(b=c(r.value))!=null?b:"":typeof r.value=="string"?r.value:""}();ce(([b,k],[y,U])=>{p.current||r.inputRef.current&&(U===0&&k===1||b!==y)&&(r.inputRef.current.value=b)},[E,r.comboboxState]),ce(([b],[k])=>{if(b===0&&k===1){let y=r.inputRef.current;if(!y)return;let U=y.value,{selectionStart:J,selectionEnd:Q,selectionDirection:W}=y;y.value="",y.value=U,W!==null?y.setSelectionRange(J,Q,W):y.setSelectionRange(J,Q)}},[r.comboboxState]);let w=d.useRef(!1),A=d.useRef(null),F=g(()=>{w.current=!0}),L=g(()=>{v.nextFrame(()=>{w.current=!1,A.current&&(a.openCombobox(),m==null||m(A.current),A.current=null)})}),$=g(b=>{switch(p.current=!0,b.key){case T.Backspace:case T.Delete:if(r.mode!==0||!r.nullable)return;let k=b.currentTarget;v.requestAnimationFrame(()=>{k.value===""&&(a.onChange(null),r.optionsRef.current&&(r.optionsRef.current.scrollTop=0),a.goToOption(I.Nothing))});break;case T.Enter:if(p.current=!1,r.comboboxState!==0||w.current)return;if(b.preventDefault(),b.stopPropagation(),r.activeOptionIndex===null){a.closeCombobox();return}a.selectActiveOption(),r.mode===0&&a.closeCombobox();break;case T.ArrowDown:return p.current=!1,b.preventDefault(),b.stopPropagation(),N(r.comboboxState,{[0]:()=>{a.goToOption(I.Next)},[1]:()=>{a.openCombobox()}});case T.ArrowUp:return p.current=!1,b.preventDefault(),b.stopPropagation(),N(r.comboboxState,{[0]:()=>{a.goToOption(I.Previous)},[1]:()=>{a.openCombobox(),v.nextFrame(()=>{r.value||a.goToOption(I.Last)})}});case T.Home:if(b.shiftKey)break;return p.current=!1,b.preventDefault(),b.stopPropagation(),a.goToOption(I.First);case T.PageUp:return p.current=!1,b.preventDefault(),b.stopPropagation(),a.goToOption(I.First);case T.End:if(b.shiftKey)break;return p.current=!1,b.preventDefault(),b.stopPropagation(),a.goToOption(I.Last);case T.PageDown:return p.current=!1,b.preventDefault(),b.stopPropagation(),a.goToOption(I.Last);case T.Escape:return p.current=!1,r.comboboxState!==0?void 0:(b.preventDefault(),r.optionsRef.current&&!r.optionsPropsRef.current.static&&b.stopPropagation(),a.closeCombobox());case T.Tab:if(p.current=!1,r.comboboxState!==0)return;r.mode===0&&a.selectActiveOption(),a.closeCombobox();break}}),D=g(b=>{if(w.current){A.current=b;return}a.openCombobox(),m==null||m(b)}),q=g(()=>{p.current=!1}),s=re(()=>{if(r.labelId)return[r.labelId].join(" ")},[r.labelId]),P=d.useMemo(()=>({open:r.comboboxState===0,disabled:r.disabled}),[r]),_={ref:h,id:R,role:"combobox",type:O,"aria-controls":(n=r.optionsRef.current)==null?void 0:n.id,"aria-expanded":r.disabled?void 0:r.comboboxState===0,"aria-activedescendant":r.activeOptionIndex===null||(o=r.options[r.activeOptionIndex])==null?void 0:o.id,"aria-labelledby":s,"aria-autocomplete":"list",defaultValue:(u=(l=e.defaultValue)!=null?l:r.defaultValue!==void 0?c==null?void 0:c(r.defaultValue):null)!=null?u:r.defaultValue,disabled:r.disabled,onCompositionStart:F,onCompositionEnd:L,onKeyDown:$,onChange:D,onBlur:q};return B({ourProps:_,theirProps:C,slot:P,defaultTag:Ve,name:"Combobox.Input"})}let je="button";function qe(e,t){var n;let o=j("Combobox.Button"),l=H("Combobox.Button"),u=X(o.buttonRef,t),i=G(),{id:R=`headlessui-combobox-button-${i}`,...m}=e,c=ne(),O=g(p=>{switch(p.key){case T.ArrowDown:return p.preventDefault(),p.stopPropagation(),o.comboboxState===1&&l.openCombobox(),c.nextFrame(()=>{var v;return(v=o.inputRef.current)==null?void 0:v.focus({preventScroll:!0})});case T.ArrowUp:return p.preventDefault(),p.stopPropagation(),o.comboboxState===1&&(l.openCombobox(),c.nextFrame(()=>{o.value||l.goToOption(I.Last)})),c.nextFrame(()=>{var v;return(v=o.inputRef.current)==null?void 0:v.focus({preventScroll:!0})});case T.Escape:return o.comboboxState!==0?void 0:(p.preventDefault(),o.optionsRef.current&&!o.optionsPropsRef.current.static&&p.stopPropagation(),l.closeCombobox(),c.nextFrame(()=>{var v;return(v=o.inputRef.current)==null?void 0:v.focus({preventScroll:!0})}));default:return}}),C=g(p=>{if(Se(p.currentTarget))return p.preventDefault();o.comboboxState===0?l.closeCombobox():(p.preventDefault(),l.openCombobox()),c.nextFrame(()=>{var v;return(v=o.inputRef.current)==null?void 0:v.focus({preventScroll:!0})})}),r=re(()=>{if(o.labelId)return[o.labelId,R].join(" ")},[o.labelId,R]),a=d.useMemo(()=>({open:o.comboboxState===0,disabled:o.disabled,value:o.value}),[o]),h={ref:u,id:R,type:Te(e,o.buttonRef),tabIndex:-1,"aria-haspopup":"listbox","aria-controls":(n=o.optionsRef.current)==null?void 0:n.id,"aria-expanded":o.disabled?void 0:o.comboboxState===0,"aria-labelledby":r,disabled:o.disabled,onClick:C,onKeyDown:O};return B({ourProps:h,theirProps:m,slot:a,defaultTag:je,name:"Combobox.Button"})}let Ue="label";function Ke(e,t){let n=G(),{id:o=`headlessui-combobox-label-${n}`,...l}=e,u=j("Combobox.Label"),i=H("Combobox.Label"),R=X(u.labelRef,t);M(()=>i.registerLabel(o),[o]);let m=g(()=>{var O;return(O=u.inputRef.current)==null?void 0:O.focus({preventScroll:!0})}),c=d.useMemo(()=>({open:u.comboboxState===0,disabled:u.disabled}),[u]);return B({ourProps:{ref:R,id:o,onClick:m},theirProps:l,slot:c,defaultTag:Ue,name:"Combobox.Label"})}let Xe="ul",Ge=ue.RenderStrategy|ue.Static;function He(e,t){let n=G(),{id:o=`headlessui-combobox-options-${n}`,hold:l=!1,...u}=e,i=j("Combobox.Options"),R=X(i.optionsRef,t),m=Re(),c=(()=>m!==null?(m&ee.Open)===ee.Open:i.comboboxState===0)();M(()=>{var a;i.optionsPropsRef.current.static=(a=e.static)!=null?a:!1},[i.optionsPropsRef,e.static]),M(()=>{i.optionsPropsRef.current.hold=l},[i.optionsPropsRef,l]),Pe({container:i.optionsRef.current,enabled:i.comboboxState===0,accept(a){return a.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:a.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(a){a.setAttribute("role","none")}});let O=re(()=>{var a,h;return(h=i.labelId)!=null?h:(a=i.buttonRef.current)==null?void 0:a.id},[i.labelId,i.buttonRef.current]),C=d.useMemo(()=>({open:i.comboboxState===0}),[i]),r={"aria-labelledby":O,role:"listbox","aria-multiselectable":i.mode===1?!0:void 0,id:o,ref:R};return B({ourProps:r,theirProps:u,slot:C,defaultTag:Xe,features:Ge,visible:c,name:"Combobox.Options"})}let Je="li";function Qe(e,t){var n,o;let l=G(),{id:u=`headlessui-combobox-option-${l}`,disabled:i=!1,value:R,...m}=e,c=j("Combobox.Option"),O=H("Combobox.Option"),C=c.activeOptionIndex!==null?c.options[c.activeOptionIndex].id===u:!1,r=c.isSelected(R),a=d.useRef(null),h=de({disabled:i,value:R,domRef:a,textValue:(o=(n=a.current)==null?void 0:n.textContent)==null?void 0:o.toLowerCase()}),p=X(t,a),v=g(()=>O.selectOption(u));M(()=>O.registerOption(u,h),[h,u]);let E=d.useRef(!c.__demoMode);M(()=>{if(!c.__demoMode)return;let s=se();return s.requestAnimationFrame(()=>{E.current=!0}),s.dispose},[]),M(()=>{if(c.comboboxState!==0||!C||!E.current||c.activationTrigger===0)return;let s=se();return s.requestAnimationFrame(()=>{var P,_;(_=(P=a.current)==null?void 0:P.scrollIntoView)==null||_.call(P,{block:"nearest"})}),s.dispose},[a,C,c.comboboxState,c.activationTrigger,c.activeOptionIndex]);let w=g(s=>{if(i)return s.preventDefault();v(),c.mode===0&&O.closeCombobox(),De()||requestAnimationFrame(()=>{var P;return(P=c.inputRef.current)==null?void 0:P.focus()})}),A=g(()=>{if(i)return O.goToOption(I.Nothing);O.goToOption(I.Specific,u)}),F=ye(),L=g(s=>F.update(s)),$=g(s=>{F.wasMoved(s)&&(i||C||O.goToOption(I.Specific,u,0))}),D=g(s=>{F.wasMoved(s)&&(i||C&&(c.optionsPropsRef.current.hold||O.goToOption(I.Nothing)))}),q=d.useMemo(()=>({active:C,selected:r,disabled:i}),[C,r,i]);return B({ourProps:{id:u,ref:p,role:"option",tabIndex:i===!0?void 0:-1,"aria-disabled":i===!0?!0:void 0,"aria-selected":r,disabled:void 0,onClick:w,onFocus:A,onPointerEnter:L,onMouseEnter:L,onPointerMove:$,onMouseMove:$,onPointerLeave:D,onMouseLeave:D},theirProps:m,slot:q,defaultTag:Je,name:"Combobox.Option"})}let We=V(Ne),Ye=V(qe),Ze=V(Be),ze=V(Ke),eo=V(He),oo=V(Qe),uo=Object.assign(We,{Input:Ze,Button:Ye,Label:ze,Options:eo,Option:oo});export{uo as W};
//# sourceMappingURL=combobox-393d016a.js.map
