import{r as p,R as z}from"./index-ec8b93d8.js";import{s as se,l as M,o as g,S as ae,D as _,u as $,p as te,c as xe,d as J,R as ge,X as V,y as K,C as Re,a as ue}from"./open-closed-aa2934ca.js";import{L as Oe,c as Ie,p as Ce,I as U,o as P,r as Se,a as he}from"./keyboard-815d6eba.js";import{s as Pe}from"./use-resolve-button-type-b6561d60.js";import{F as Te,u as ye,a as C,x as Ee}from"./use-tracked-pointer-b81bf215.js";import{m as ce,n as De}from"./platform-42294b71.js";function ne(e,t){let[n,o]=p.useState(e),a=se(e);return M(()=>o(a.current),[a,o,...t]),n}function de(e={},t=null,n=[]){for(let[o,a]of Object.entries(e))be(n,pe(t,o),a);return n}function pe(e,t){return e?e+"["+t+"]":t}function be(e,t,n){if(Array.isArray(n))for(let[o,a]of n.entries())be(e,pe(t,o.toString()),a);else n instanceof Date?e.push([t,n.toISOString()]):typeof n=="boolean"?e.push([t,n?"1":"0"]):typeof n=="string"?e.push([t,n]):typeof n=="number"?e.push([t,`${n}`]):n==null?e.push([t,""]):de(n,t,e)}function Me(e,t,n){let[o,a]=p.useState(n),u=e!==void 0,i=p.useRef(u),R=p.useRef(!1),v=p.useRef(!1);return u&&!i.current&&!R.current?(R.current=!0,i.current=u,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!u&&i.current&&!v.current&&(v.current=!0,i.current=u,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[u?e:o,g(s=>(u||a(s),t==null?void 0:t(s)))]}var Fe=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Fe||{}),ke=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(ke||{}),we=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(we||{}),Le=(e=>(e[e.OpenCombobox=0]="OpenCombobox",e[e.CloseCombobox=1]="CloseCombobox",e[e.GoToOption=2]="GoToOption",e[e.RegisterOption=3]="RegisterOption",e[e.UnregisterOption=4]="UnregisterOption",e[e.RegisterLabel=5]="RegisterLabel",e))(Le||{});function oe(e,t=n=>n){let n=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,o=he(t(e.options.slice()),u=>u.dataRef.current.domRef.current),a=n?o.indexOf(n):null;return a===-1&&(a=null),{options:o,activeOptionIndex:a}}let Ae={[1](e){var t;return(t=e.dataRef.current)!=null&&t.disabled||e.comboboxState===1?e:{...e,activeOptionIndex:null,comboboxState:1}},[0](e){var t;if((t=e.dataRef.current)!=null&&t.disabled||e.comboboxState===0)return e;let n=e.activeOptionIndex;if(e.dataRef.current){let{isSelected:o}=e.dataRef.current,a=e.options.findIndex(u=>o(u.dataRef.current.value));a!==-1&&(n=a)}return{...e,comboboxState:0,activeOptionIndex:n}},[2](e,t){var n,o,a,u;if((n=e.dataRef.current)!=null&&n.disabled||(o=e.dataRef.current)!=null&&o.optionsRef.current&&!((a=e.dataRef.current)!=null&&a.optionsPropsRef.current.static)&&e.comboboxState===1)return e;let i=oe(e);if(i.activeOptionIndex===null){let v=i.options.findIndex(s=>!s.dataRef.current.disabled);v!==-1&&(i.activeOptionIndex=v)}let R=Ee(t,{resolveItems:()=>i.options,resolveActiveIndex:()=>i.activeOptionIndex,resolveId:v=>v.id,resolveDisabled:v=>v.dataRef.current.disabled});return{...e,...i,activeOptionIndex:R,activationTrigger:(u=t.trigger)!=null?u:1}},[3]:(e,t)=>{var n,o;let a={id:t.id,dataRef:t.dataRef},u=oe(e,R=>[...R,a]);e.activeOptionIndex===null&&(n=e.dataRef.current)!=null&&n.isSelected(t.dataRef.current.value)&&(u.activeOptionIndex=u.options.indexOf(a));let i={...e,...u,activationTrigger:1};return(o=e.dataRef.current)!=null&&o.__demoMode&&e.dataRef.current.value===void 0&&(i.activeOptionIndex=0),i},[4]:(e,t)=>{let n=oe(e,o=>{let a=o.findIndex(u=>u.id===t.id);return a!==-1&&o.splice(a,1),o});return{...e,...n,activationTrigger:1}},[5]:(e,t)=>({...e,labelId:t.id})},re=p.createContext(null);re.displayName="ComboboxActionsContext";function H(e){let t=p.useContext(re);if(t===null){let n=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,H),n}return t}let ie=p.createContext(null);ie.displayName="ComboboxDataContext";function N(e){let t=p.useContext(ie);if(t===null){let n=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,N),n}return t}function $e(e,t){return $(t.type,Ae,e,t)}let _e=p.Fragment;function Ve(e,t){let{value:n,defaultValue:o,onChange:a,form:u,name:i,by:R=(f,x)=>f===x,disabled:v=!1,__demoMode:s=!1,nullable:O=!1,multiple:I=!1,...r}=e,[l=I?[]:void 0,h]=Me(n,a,o),[b,m]=p.useReducer($e,{dataRef:p.createRef(),comboboxState:s?0:1,options:[],activeOptionIndex:null,activationTrigger:1,labelId:null}),E=p.useRef(!1),F=p.useRef({static:!1,hold:!1}),B=p.useRef(null),k=p.useRef(null),L=p.useRef(null),A=p.useRef(null),D=g(typeof R=="string"?(f,x)=>{let S=R;return(f==null?void 0:f[S])===(x==null?void 0:x[S])}:R),q=p.useCallback(f=>$(c.mode,{[1]:()=>l.some(x=>D(x,f)),[0]:()=>D(l,f)}),[l]),c=p.useMemo(()=>({...b,optionsPropsRef:F,labelRef:B,inputRef:k,buttonRef:L,optionsRef:A,value:l,defaultValue:o,disabled:v,mode:I?1:0,get activeOptionIndex(){if(E.current&&b.activeOptionIndex===null&&b.options.length>0){let f=b.options.findIndex(x=>!x.dataRef.current.disabled);if(f!==-1)return f}return b.activeOptionIndex},compare:D,isSelected:q,nullable:O,__demoMode:s}),[l,o,v,I,O,s,b]),T=p.useRef(c.activeOptionIndex!==null?c.options[c.activeOptionIndex]:null);p.useEffect(()=>{let f=c.activeOptionIndex!==null?c.options[c.activeOptionIndex]:null;T.current!==f&&(T.current=f)}),M(()=>{b.dataRef.current=c},[c]),Oe([c.buttonRef,c.inputRef,c.optionsRef],()=>ee.closeCombobox(),c.comboboxState===0);let d=p.useMemo(()=>({open:c.comboboxState===0,disabled:v,activeIndex:c.activeOptionIndex,activeOption:c.activeOptionIndex===null?null:c.options[c.activeOptionIndex].dataRef.current.value,value:l}),[c,v,l]),w=g(f=>{let x=c.options.find(S=>S.id===f);x&&G(x.dataRef.current.value)}),y=g(()=>{if(c.activeOptionIndex!==null){let{dataRef:f,id:x}=c.options[c.activeOptionIndex];G(f.current.value),ee.goToOption(C.Specific,x)}}),j=g(()=>{m({type:0}),E.current=!0}),X=g(()=>{m({type:1}),E.current=!1}),Q=g((f,x,S)=>(E.current=!1,f===C.Specific?m({type:2,focus:C.Specific,id:x,trigger:S}):m({type:2,focus:f,trigger:S}))),W=g((f,x)=>(m({type:3,id:f,dataRef:x}),()=>{var S;((S=T.current)==null?void 0:S.id)===f&&(E.current=!0),m({type:4,id:f})})),fe=g(f=>(m({type:5,id:f}),()=>m({type:5,id:null}))),G=g(f=>$(c.mode,{[0](){return h==null?void 0:h(f)},[1](){let x=c.value.slice(),S=x.findIndex(Z=>D(Z,f));return S===-1?x.push(f):x.splice(S,1),h==null?void 0:h(x)}})),ee=p.useMemo(()=>({onChange:G,registerOption:W,registerLabel:fe,goToOption:Q,closeCombobox:X,openCombobox:j,selectActiveOption:y,selectOption:w}),[]),ve=t===null?{}:{ref:t},Y=p.useRef(null),me=te();return p.useEffect(()=>{Y.current&&o!==void 0&&me.addEventListener(Y.current,"reset",()=>{G(o)})},[Y,G]),z.createElement(re.Provider,{value:ee},z.createElement(ie.Provider,{value:c},z.createElement(xe,{value:$(c.comboboxState,{[0]:J.Open,[1]:J.Closed})},i!=null&&l!=null&&de({[i]:l}).map(([f,x],S)=>z.createElement(Ie,{features:Ce.Hidden,ref:S===0?Z=>{var le;Y.current=(le=Z==null?void 0:Z.closest("form"))!=null?le:null}:void 0,...ge({key:f,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:u,name:f,value:x})})),V({ourProps:ve,theirProps:r,slot:d,defaultTag:_e,name:"Combobox"}))))}let Ne="input";function Be(e,t){var n,o,a,u;let i=U(),{id:R=`headlessui-combobox-input-${i}`,onChange:v,displayValue:s,type:O="text",...I}=e,r=N("Combobox.Input"),l=H("Combobox.Input"),h=K(r.inputRef,t),b=p.useRef(!1),m=te(),E=function(){var d;return typeof s=="function"&&r.value!==void 0?(d=s(r.value))!=null?d:"":typeof r.value=="string"?r.value:""}();ce(([d,w],[y,j])=>{b.current||r.inputRef.current&&(j===0&&w===1||d!==y)&&(r.inputRef.current.value=d)},[E,r.comboboxState]),ce(([d],[w])=>{if(d===0&&w===1){let y=r.inputRef.current;if(!y)return;let j=y.value,{selectionStart:X,selectionEnd:Q,selectionDirection:W}=y;y.value="",y.value=j,W!==null?y.setSelectionRange(X,Q,W):y.setSelectionRange(X,Q)}},[r.comboboxState]);let F=p.useRef(!1),B=g(()=>{F.current=!0}),k=g(()=>{setTimeout(()=>{F.current=!1})}),L=g(d=>{switch(b.current=!0,d.key){case P.Backspace:case P.Delete:if(r.mode!==0||!r.nullable)return;let w=d.currentTarget;m.requestAnimationFrame(()=>{w.value===""&&(l.onChange(null),r.optionsRef.current&&(r.optionsRef.current.scrollTop=0),l.goToOption(C.Nothing))});break;case P.Enter:if(b.current=!1,r.comboboxState!==0||F.current)return;if(d.preventDefault(),d.stopPropagation(),r.activeOptionIndex===null){l.closeCombobox();return}l.selectActiveOption(),r.mode===0&&l.closeCombobox();break;case P.ArrowDown:return b.current=!1,d.preventDefault(),d.stopPropagation(),$(r.comboboxState,{[0]:()=>{l.goToOption(C.Next)},[1]:()=>{l.openCombobox()}});case P.ArrowUp:return b.current=!1,d.preventDefault(),d.stopPropagation(),$(r.comboboxState,{[0]:()=>{l.goToOption(C.Previous)},[1]:()=>{l.openCombobox(),m.nextFrame(()=>{r.value||l.goToOption(C.Last)})}});case P.Home:if(d.shiftKey)break;return b.current=!1,d.preventDefault(),d.stopPropagation(),l.goToOption(C.First);case P.PageUp:return b.current=!1,d.preventDefault(),d.stopPropagation(),l.goToOption(C.First);case P.End:if(d.shiftKey)break;return b.current=!1,d.preventDefault(),d.stopPropagation(),l.goToOption(C.Last);case P.PageDown:return b.current=!1,d.preventDefault(),d.stopPropagation(),l.goToOption(C.Last);case P.Escape:return b.current=!1,r.comboboxState!==0?void 0:(d.preventDefault(),r.optionsRef.current&&!r.optionsPropsRef.current.static&&d.stopPropagation(),l.closeCombobox());case P.Tab:if(b.current=!1,r.comboboxState!==0)return;r.mode===0&&l.selectActiveOption(),l.closeCombobox();break}}),A=g(d=>{l.openCombobox(),v==null||v(d)}),D=g(()=>{b.current=!1}),q=ne(()=>{if(r.labelId)return[r.labelId].join(" ")},[r.labelId]),c=p.useMemo(()=>({open:r.comboboxState===0,disabled:r.disabled}),[r]),T={ref:h,id:R,role:"combobox",type:O,"aria-controls":(n=r.optionsRef.current)==null?void 0:n.id,"aria-expanded":r.disabled?void 0:r.comboboxState===0,"aria-activedescendant":r.activeOptionIndex===null||(o=r.options[r.activeOptionIndex])==null?void 0:o.id,"aria-labelledby":q,"aria-autocomplete":"list",defaultValue:(u=(a=e.defaultValue)!=null?a:r.defaultValue!==void 0?s==null?void 0:s(r.defaultValue):null)!=null?u:r.defaultValue,disabled:r.disabled,onCompositionStart:B,onCompositionEnd:k,onKeyDown:L,onChange:A,onBlur:D};return V({ourProps:T,theirProps:I,slot:c,defaultTag:Ne,name:"Combobox.Input"})}let qe="button";function je(e,t){var n;let o=N("Combobox.Button"),a=H("Combobox.Button"),u=K(o.buttonRef,t),i=U(),{id:R=`headlessui-combobox-button-${i}`,...v}=e,s=te(),O=g(b=>{switch(b.key){case P.ArrowDown:return b.preventDefault(),b.stopPropagation(),o.comboboxState===1&&a.openCombobox(),s.nextFrame(()=>{var m;return(m=o.inputRef.current)==null?void 0:m.focus({preventScroll:!0})});case P.ArrowUp:return b.preventDefault(),b.stopPropagation(),o.comboboxState===1&&(a.openCombobox(),s.nextFrame(()=>{o.value||a.goToOption(C.Last)})),s.nextFrame(()=>{var m;return(m=o.inputRef.current)==null?void 0:m.focus({preventScroll:!0})});case P.Escape:return o.comboboxState!==0?void 0:(b.preventDefault(),o.optionsRef.current&&!o.optionsPropsRef.current.static&&b.stopPropagation(),a.closeCombobox(),s.nextFrame(()=>{var m;return(m=o.inputRef.current)==null?void 0:m.focus({preventScroll:!0})}));default:return}}),I=g(b=>{if(Se(b.currentTarget))return b.preventDefault();o.comboboxState===0?a.closeCombobox():(b.preventDefault(),a.openCombobox()),s.nextFrame(()=>{var m;return(m=o.inputRef.current)==null?void 0:m.focus({preventScroll:!0})})}),r=ne(()=>{if(o.labelId)return[o.labelId,R].join(" ")},[o.labelId,R]),l=p.useMemo(()=>({open:o.comboboxState===0,disabled:o.disabled,value:o.value}),[o]),h={ref:u,id:R,type:Pe(e,o.buttonRef),tabIndex:-1,"aria-haspopup":"listbox","aria-controls":(n=o.optionsRef.current)==null?void 0:n.id,"aria-expanded":o.disabled?void 0:o.comboboxState===0,"aria-labelledby":r,disabled:o.disabled,onClick:I,onKeyDown:O};return V({ourProps:h,theirProps:v,slot:l,defaultTag:qe,name:"Combobox.Button"})}let Ge="label";function Ke(e,t){let n=U(),{id:o=`headlessui-combobox-label-${n}`,...a}=e,u=N("Combobox.Label"),i=H("Combobox.Label"),R=K(u.labelRef,t);M(()=>i.registerLabel(o),[o]);let v=g(()=>{var O;return(O=u.inputRef.current)==null?void 0:O.focus({preventScroll:!0})}),s=p.useMemo(()=>({open:u.comboboxState===0,disabled:u.disabled}),[u]);return V({ourProps:{ref:R,id:o,onClick:v},theirProps:a,slot:s,defaultTag:Ge,name:"Combobox.Label"})}let Ue="ul",He=ae.RenderStrategy|ae.Static;function Xe(e,t){let n=U(),{id:o=`headlessui-combobox-options-${n}`,hold:a=!1,...u}=e,i=N("Combobox.Options"),R=K(i.optionsRef,t),v=Re(),s=(()=>v!==null?(v&J.Open)===J.Open:i.comboboxState===0)();M(()=>{var l;i.optionsPropsRef.current.static=(l=e.static)!=null?l:!1},[i.optionsPropsRef,e.static]),M(()=>{i.optionsPropsRef.current.hold=a},[i.optionsPropsRef,a]),Te({container:i.optionsRef.current,enabled:i.comboboxState===0,accept(l){return l.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:l.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(l){l.setAttribute("role","none")}});let O=ne(()=>{var l,h;return(h=i.labelId)!=null?h:(l=i.buttonRef.current)==null?void 0:l.id},[i.labelId,i.buttonRef.current]),I=p.useMemo(()=>({open:i.comboboxState===0}),[i]),r={"aria-labelledby":O,role:"listbox","aria-multiselectable":i.mode===1?!0:void 0,id:o,ref:R};return V({ourProps:r,theirProps:u,slot:I,defaultTag:Ue,features:He,visible:s,name:"Combobox.Options"})}let Qe="li";function We(e,t){var n,o;let a=U(),{id:u=`headlessui-combobox-option-${a}`,disabled:i=!1,value:R,...v}=e,s=N("Combobox.Option"),O=H("Combobox.Option"),I=s.activeOptionIndex!==null?s.options[s.activeOptionIndex].id===u:!1,r=s.isSelected(R),l=p.useRef(null),h=se({disabled:i,value:R,domRef:l,textValue:(o=(n=l.current)==null?void 0:n.textContent)==null?void 0:o.toLowerCase()}),b=K(t,l),m=g(()=>O.selectOption(u));M(()=>O.registerOption(u,h),[h,u]);let E=p.useRef(!s.__demoMode);M(()=>{if(!s.__demoMode)return;let c=ue();return c.requestAnimationFrame(()=>{E.current=!0}),c.dispose},[]),M(()=>{if(s.comboboxState!==0||!I||!E.current||s.activationTrigger===0)return;let c=ue();return c.requestAnimationFrame(()=>{var T,d;(d=(T=l.current)==null?void 0:T.scrollIntoView)==null||d.call(T,{block:"nearest"})}),c.dispose},[l,I,s.comboboxState,s.activationTrigger,s.activeOptionIndex]);let F=g(c=>{if(i)return c.preventDefault();m(),s.mode===0&&O.closeCombobox(),De()||requestAnimationFrame(()=>{var T;return(T=s.inputRef.current)==null?void 0:T.focus()})}),B=g(()=>{if(i)return O.goToOption(C.Nothing);O.goToOption(C.Specific,u)}),k=ye(),L=g(c=>k.update(c)),A=g(c=>{k.wasMoved(c)&&(i||I||O.goToOption(C.Specific,u,0))}),D=g(c=>{k.wasMoved(c)&&(i||I&&(s.optionsPropsRef.current.hold||O.goToOption(C.Nothing)))}),q=p.useMemo(()=>({active:I,selected:r,disabled:i}),[I,r,i]);return V({ourProps:{id:u,ref:b,role:"option",tabIndex:i===!0?void 0:-1,"aria-disabled":i===!0?!0:void 0,"aria-selected":r,disabled:void 0,onClick:F,onFocus:B,onPointerEnter:L,onMouseEnter:L,onPointerMove:A,onMouseMove:A,onPointerLeave:D,onMouseLeave:D},theirProps:v,slot:q,defaultTag:Qe,name:"Combobox.Option"})}let Ye=_(Ve),Ze=_(je),ze=_(Be),Je=_(Ke),eo=_(Xe),oo=_(We),uo=Object.assign(Ye,{Input:ze,Button:Ze,Label:Je,Options:eo,Option:oo});export{uo as W};
//# sourceMappingURL=combobox-b5286f3e.js.map
